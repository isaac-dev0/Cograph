# ------------------------------------------------------
# THIS FILE WAS AUTOMATICALLY GENERATED (DO NOT MODIFY)
# ------------------------------------------------------

type Profile {
  id: ID!
  userId: String!
  email: String!
  displayName: String!
  job: String
  location: String
  avatarUrl: String
  createdAt: DateTime!
  updatedAt: DateTime!
}

"""
A date-time string at UTC, such as 2019-12-03T09:54:33Z, compliant with the date-time format.
"""
scalar DateTime

"""Represents a user who is part of a project."""
type ProjectMember {
  """
  Unique identifier of the user (profile) associated with this membership.
  """
  profileId: ID!

  """Unique identifier of the project this member belongs to."""
  projectId: ID!

  """Role of the user within the project, e.g., OWNER, ADMIN, or MEMBER."""
  role: ProjectRole!

  """Profile of the user."""
  profile: Profile!

  """Timestamp of when this member was added to the project."""
  createdAt: DateTime!

  """Timestamp of the last update to this project member record."""
  updatedAt: DateTime!
}

"""Specifies the level of permissions a member has within a project."""
enum ProjectRole {
  OWNER
  ADMIN
  MEMBER
  GUEST
}

"""
A project that contains members, an owner, and metadata such as name and description.
"""
type Project {
  """Unique identifier of the project."""
  id: ID!

  """The name of the project."""
  name: String!

  """Optional text description of the project's purpose or details."""
  description: String

  """URL to the project logo image."""
  icon: String

  """Unique identifier of the user who owns this project."""
  ownerId: ID!

  """Status of the project, e.g., ACTIVE, ARCHIVED"""
  status: ProjectStatus!

  """Timestamp of when the project was created."""
  createdAt: DateTime!

  """Timestamp of the last update to the project."""
  updatedAt: DateTime!

  """Timestamp of when the project was archived."""
  archivedAt: DateTime

  """Owner object of the project"""
  owner: Profile

  """Members of the project"""
  members: [ProjectMember!]
}

"""Specifies the status of a project."""
enum ProjectStatus {
  ACTIVE
  ARCHIVED
}

"""History of sync operations performed on a repository."""
type RepositorySyncHistory {
  """Unique identifier of the sync history record."""
  id: ID!

  """ID of the repository this sync history entry belongs to."""
  repositoryId: String!

  """The repository associated with this sync event."""
  repository: Repository!

  """Timestamp when the sync process started."""
  syncStartedAt: DateTime!

  """Timestamp when the sync process finished."""
  syncCompletedAt: DateTime

  """Status of the sync process (e.g., PENDING, SUCCESS, FAILED)."""
  status: String!

  """Error message from the sync process, if any."""
  error: String

  """Number of files processed during the sync."""
  filesProcessed: Int!

  """Duration of the sync in milliseconds."""
  duration: Int

  """Timestamp when this sync history record was created."""
  createdAt: DateTime!
}

"""A repository that contains files from Github."""
type Repository {
  """Unique identifier of the repository."""
  id: ID!

  """Unique identifier of the Github repository."""
  githubId: Int!

  """Unique identifier of the node."""
  nodeId: String!

  """Name of the repository."""
  name: String!

  """Full name of the repository with organisation or user slug."""
  fullName: String!

  """Description of the repository"""
  description: String

  """Visibility of the Github repository"""
  visibility: String!

  """URL of the Github repository"""
  repositoryUrl: String!

  """Icon/logo URL for the repository."""
  icon: String

  """Login of the repository owner."""
  ownerLogin: String!

  """Type of the owner such as organisation or user."""
  ownerType: String!

  """Avatar URL for the owner of the repository."""
  ownerAvatarUrl: String!

  """Date when the repository was last synced."""
  lastSyncedAt: DateTime

  """Status of the repository sync, e.g., PENDING, SYNCING, SYNCED, FAILED"""
  syncStatus: SyncStatus!

  """Error encountered from syncing."""
  syncError: String

  """Is the repository currently archived?"""
  isArchived: Boolean!

  """Is the repository currently disabled?"""
  isDisabled: Boolean!

  """Is the repository public or private?"""
  isPrivate: Boolean!

  """Github timestamp of when the repository was created."""
  githubCreatedAt: DateTime!

  """Github timestamp of the last update to the repository."""
  githubUpdatedAt: DateTime!

  """Timestamp of when the repository was previously pushed to."""
  githubPushedAt: DateTime!

  """Timestamp of when the repository was created."""
  createdAt: DateTime!

  """Timestamp of the last update to the repository."""
  updatedAt: DateTime!

  """Timestamp of when the repository was archived."""
  archivedAt: DateTime
  syncHistory: [RepositorySyncHistory!]
}

"""Specifies the status of a sync operation"""
enum SyncStatus {
  PENDING
  SYNCING
  SYNCED
  FAILED
}

type Query {
  """Finds a profile based on Profile ID"""
  findProfileById(id: String!): Profile!

  """Finds a profile based on a Supabase Auth ID"""
  findProfileByUserId(userId: String!): Profile!

  """Finds a project by its unique ID"""
  findProjectById(projectId: ID!): Project!

  """Finds projects that the specified profile is a member of."""
  findProjectsByProfileId(profileId: ID!): [Project!]!

  """Finds all project members"""
  findProjectMembers(projectId: ID!): [ProjectMember!]!

  """Finds repositories associated with a specific project."""
  findRepositoriesByProjectId(projectId: ID!): [Repository!]!

  """Finds all repositories with optional filters."""
  findAllRepositories(options: FindRepositoriesInput): [Repository!]!

  """Finds a repository by its GitHub ID."""
  findRepositoryByGithubId(githubId: Int!): Repository

  """Finds a repository by its full name (e.g., "owner/repo")."""
  findRepositoryByFullName(fullName: String!): Repository
}

input FindRepositoriesInput {
  includeArchived: Boolean
  includePrivate: Boolean
  owner: String
}

type Mutation {
  """Finds or creates a user profile based on Supabase Auth Data (Upsert)."""
  syncProfile(data: SyncProfileInput!): Profile!

  """Updates the authenticated user's profile"""
  updateProfile(updateProfileInput: UpdateProfileInput!): Profile!

  """Creates a project given the specified parameters."""
  createProject(createProjectInput: CreateProjectInput!): Project!

  """Updates an existing project."""
  updateProject(projectId: ID!, updateProjectInput: UpdateProjectInput!): Project!

  """Updates a project member's role."""
  updateProjectMemberRole(projectId: ID!, memberId: ID!, role: ProjectRole!): ProjectMember!

  """Transfers ownership of a project to another member."""
  transferProjectOwnership(projectId: ID!, newOwnerId: ID!): Project!

  """Adds one or more members to a project."""
  addProjectMembers(projectId: ID!, profileIds: [ID!]!): [ProjectMember!]!

  """Removes a member from a project."""
  removeProjectMember(projectId: ID!, profileId: ID!): ProjectMember!

  """Archives a project (soft delete)."""
  archiveProject(projectId: ID!): Project!

  """
  Fetches repositories from GitHub API and imports them into the database.
  """
  syncRepositoriesFromGitHub(input: SyncRepositoriesInput!): Boolean!

  """Archives a repository (soft delete)."""
  archiveRepository(repositoryId: ID!): Repository!

  """Adds one or more repositories to a project."""
  addRepositoriesToProject(projectId: ID!, repositoryIds: [ID!]!): Boolean!

  """Removes a repository from a project."""
  removeRepositoryFromProject(projectId: ID!, repositoryId: ID!): Boolean!
}

input SyncProfileInput {
  """The unique Supabase Auth User ID (UID)."""
  userId: ID!

  """The user's email address."""
  email: String!

  """The user's public display name."""
  displayName: String!
}

input UpdateProfileInput {
  job: String
  location: String
  avatarUrl: String
}

input CreateProjectInput {
  """Name of the project"""
  name: String!

  """Description of the project"""
  description: String

  """Supabase User ID of the project owner"""
  ownerId: ID!
}

input UpdateProjectInput {
  """Name of the project"""
  name: String

  """Description of the project"""
  description: String

  """Supabase User ID of the project owner"""
  ownerId: ID
}

input SyncRepositoriesInput {
  """GitHub access token for authenticating with GitHub API"""
  githubToken: String!
}